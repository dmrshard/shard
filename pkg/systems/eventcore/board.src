//-----------------------------------------------------------------------------// Modified: 2013-06-08//-----------------------------------------------------------------------------include "include/gumps";include "include/gumpboxes";include "include/gump_utils";include "include/clock";include "include/move";include ":eventcore:event_data";include ":eventcore:event_gump";include ":eventcore:common";//-----------------------------------------------------------------------------program EventBoard(who, board)  __ParamUnused(board);  var Data := GetEventsData();  while(IsLoggedIn(who))    var EventID := SelectEvent(who);    if(EventID)      var Event := Data.FindElement(EVENT_TITLE+EventID);      BuildEventPlayers(who, EventID, Event);    else      break;    endif  endwhileendprogram//-----------------------------------------------------------------------------function SelectEvent(who)  var Data := GetEventsData();  var Keys := GetDataKeys(Data, EVENT_TITLE, BQG_ZEROFILL);  Keys.sort();  Keys.reverse();  BuildEventsList(Keys, Data);  var EventId := error;  var Res := CInt(GSend(who).butid);  if(Res)    EventID := CInt(UnZeroFill(Keys[Res]));  endif  return EventID;endfunction//-----------------------------------------------------------------------------function BuildEventsList(byref Keys, Data)  BQGInit("Wydarzenia", 700, 500, 0, 1, 80, 50);  GAddPageData(665,18,2650,2651,665,467,2648,2647);  GTextLine(30,  40, 999, "Osoby");  GTextLine(80, 40, 999, "Tytul");  GTextLine(340, 40, 999, "Pozostaly czas");  GTextLine(540, 40, 999, "Dzien i godzina");  GMultiPage();  var Event, i := 1;  foreach Key in Keys    GCheckNextPage(20);    Event := Data.FindElement(EVENT_TITLE+UnZeroFill(Key));    if(Event.GetProp("Disabled"))      continue;    endif    GButton(50, 63+GNPCount()*20, 2117, 2118, i);    GTextLine(80,60+GNPCount()*20, 550, Event.GetProp("Name"));        var LeftTime := GetTimeLeftForEvent(Event);    if(LeftTime != error)//      if(IsAdmin(who))      GTextLine(340, 60+GNPCount()*20, 1321, DescRealTime(LeftTime[1]));//      else//        GTextLine(280, 60+GNPCount()*20, 1321, DescGameTime(LeftTime[1]));//      endif    else      GTextLine(340, 60+GNPCount()*20, 1211, "Nieaktywny");    endif    GTextLine(540,60+GNPCount()*20, 560, GetDayName(LeftTime[2]));    GTextLine(630,60+GNPCount()*20, 1421, LeftTime[3]);    i := i + 1;  endforeachendfunction//-----------------------------------------------------------------------------